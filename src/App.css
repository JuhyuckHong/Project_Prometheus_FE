.page {
    padding: 1rem; /* top/bottom 1rem; bottom nav spacing handled by .app-content */
}
.table-wrap {
    overflow-x: auto;
}

.asset-table {
    width: 100%;
    border-collapse: collapse;
    background: #fff;
}

.asset-table th,
.asset-table td {
    border-bottom: 1px solid #eee;
    padding: 0.65rem 0.75rem;
    text-align: left;
    white-space: nowrap;
}

.asset-table thead th {
    background: #fafafa;
    font-weight: 600;
}

/* Inline status toggle inside asset table */
.status-toggle {
    display: inline-flex;
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    margin-top: 0.35rem;
}
.status-toggle .toggle-btn {
    background: #fff;
    border: 0;
    font-size: 0.78rem;
    padding: 0.3rem 0.55rem;
}
.status-toggle .toggle-btn + .toggle-btn {
    border-left: 1px solid #eee;
}
.status-toggle .toggle-btn:disabled {
    opacity: 0.55;
    cursor: not-allowed;
}

.badge {
    display: inline-block;
    padding: 0.2rem 0.5rem;
    border-radius: 999px;
    font-size: 0.8rem;
    line-height: 1;
}

.badge--available {
    background: #e9f8ee;
    color: #177245;
}
.badge--rented {
    background: #e3f2fd;
    color: #0b57d0; /* match marker--rented (blue) */
}
.badge--overdue {
    background: #fff4e5;
    color: #f59e0b; /* match marker--overdue */
}
.badge--suspicious {
    background: #ff1744;
    color: #f1eaea; /* match marker--suspicious */
}
.badge--maintenance {
    background: #fdecef;
    color: #b71c1c;
}

/* Hide mistakenly added extra columns on rentals table only */
.rentals-table th:nth-last-child(-n + 4),
.rentals-table td:nth-last-child(-n + 4) {
    display: none;
}

/* Simple ON/OFF badges for device/engine */
.badge--on {
    background: #e9f8ee;
    color: #177245;
}
.badge--off {
    background: #f3f4f6;
    color: #374151;
}

.empty {
    color: #666;
    padding: 1rem 0;
}

/* Rentals: view toggle and map */
.page {
    height: 100%;
    display: flex;
    flex-direction: column;
}
html,
body,
#root {
    height: 100%;
}
html,
body {
    overflow: hidden;
}
.app-layout {
    min-height: 100%;
    height: 100%;
    display: flex;
    flex-direction: row; /* left sidebar + main content by default */
}
.app-content {
    flex: 1 1 auto;
    min-height: 0;
    min-width: 0; /* prevent flex overflow in row layout */
    overflow: hidden;
    /* no bottom padding; nav moved to left */
}

/* Left-side navigation bar */
.navigation-bar {
    /* Fix width without causing flex overflow (padding/border included) */
    box-sizing: border-box;
    width: 80px; /* fixed sidebar width */
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    padding: 12px 8px;
    background: #fff;
    border-right: 1px solid #e5e5e5;
    /* Make sidebar handle small landscape heights gracefully */
    position: sticky;
    top: 0;
    max-height: 100vh; /* fallback */
    max-height: 100dvh; /* modern mobile browsers */
    overflow-y: auto; /* vertical scroll only when needed */
    overflow-x: hidden; /* avoid horizontal scrollbar in sidebar */
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
}

.navigation-bar__logout {
    margin-top: auto;
}

.navigation-bar__link {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 10px 8px;
    color: #444;
    text-decoration: none;
    background: transparent;
    border-radius: 10px;
    border: none; /* for button */
    cursor: pointer;
}

.navigation-bar__link:hover {
    background: #f5f5f5;
}

.navigation-bar__link.is-active {
    background: #e8f0fe;
    color: #1a73e8;
}

.navigation-bar__icon {
    font-size: 20px;
}

.navigation-bar__label {
    font-size: 12px;
}

/*
    Responsive behavior for phones (portrait):
    - Move navigation to the bottom as a horizontal bar
    - Give content the full width
*/
@media (orientation: portrait) and (max-width: 768px) {
    .app-layout {
        flex-direction: column; /* content above, nav below */
    }

    .navigation-bar {
        order: 2;
        flex: 0 0 auto;
        width: 100%;
        flex-direction: row;
        justify-content: space-around;
        align-items: center;
        gap: 4px;
        padding: 6px 8px calc(6px + env(safe-area-inset-bottom, 0px));
        border-right: 0;
        border-top: 1px solid #e5e5e5;
        /* Stick to bottom without covering content (still occupies layout space) */
        position: sticky;
        top: auto;
        bottom: 0;
        height: auto;
        max-height: none;
        overflow: visible;
        backdrop-filter: saturate(140%) blur(2px);
        background: rgba(255, 255, 255, 0.98);
    }

    .navigation-bar__link {
        flex: 1 1 auto;
        padding: 8px 4px;
        min-width: 0; /* allow shrinking evenly */
    }

    .navigation-bar__logout {
        margin-top: 0; /* reset vertical auto push in horizontal layout */
    }
}
.view-toggle {
    display: inline-flex;
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 0.75rem;
}
.toggle-btn {
    background: #fff;
    border: none;
    padding: 0.5rem 0.9rem;
    cursor: pointer;
    color: #444;
}
.toggle-btn + .toggle-btn {
    border-left: 1px solid #ddd;
}
.toggle-btn.is-active {
    background: #0057e7;
    color: #fff;
}
/* Light spacing for toolbar when used in sticky header */
.sticky-header .view-toggle {
    margin-bottom: 0;
}

/* Sticky header wrapper for top controls */
.sticky-header {
    position: sticky;
    top: 0;
    z-index: 200;
    background: #fff;
    padding: 0.25rem 0;
}

/* Header row for detail page: align actions left and saved indicator right */
.header-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
}
.saved-indicator {
    margin-right: 8px;
    color: #2e7d32;
    font-weight: 600;
}

.map-view {
    display: flex;
    flex-direction: column;
    flex: 1 1 auto;
    min-height: 0;
}
.map-container {
    width: 100%;
    flex: 1 1 auto;
    height: auto;
    min-height: 200px;
    border: 1px solid #e5e5e5;
    border-radius: 8px;
}
.mini-map {
    height: 340px;
    min-height: 280px;
}

.legend {
    display: flex;
    gap: 0.75rem;
    align-items: center;
    margin-bottom: 0.5rem;
}
.legend__item {
    color: #444;
    font-size: 0.9rem;
}

/* Simple text-based markers for Leaflet */
/* Leaflet divIcon markers: ensure our CSS wins regardless of load order */
.marker,
.leaflet-marker-icon.marker,
.leaflet-div-icon.marker {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px !important;
    height: 28px !important;
    border-radius: 50%;
    /* font-size no longer needed for svg icons */
    color: #fff;
    line-height: 1;
    border: 2px solid #fff;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
}
.marker--car {
    background: #6b7280;
}
.leaflet-marker-icon.marker.marker--car {
    background: #6b7280;
}
.marker--rental {
    background: #0b57d0;
}
.marker--return {
    background: #c62828;
}
.marker--current {
    background: #1565c0;
}
.marker--rented {
    background: #0b57d0;
}
.marker--overdue {
    background: #f59e0b;
}
.marker--suspicious {
    background: #c62828;
}
.leaflet-marker-icon.marker.marker--current {
    background: #1565c0;
}
.leaflet-marker-icon.marker.marker--rented {
    background: #0b57d0;
}
.leaflet-marker-icon.marker.marker--overdue {
    background: #f59e0b;
}
.leaflet-marker-icon.marker.marker--suspicious {
    background: #c62828;
}

/* Geofence marker: hatch pattern inside circle (gray, 45deg) */
.marker--geo,
.leaflet-marker-icon.marker.marker--geo {
    background-color: #f3f4f6; /* light gray base */
    background-image: repeating-linear-gradient(
        45deg,
        rgba(107, 114, 128, 0.32) 0px,
        /* gray line */ rgba(107, 114, 128, 0.32) 2px,
        transparent 2px,
        transparent 8px /* 2px line + 6px gap => 8px period */
    );
    border-color: #6b7280; /* gray border */
}

/* Small SVG icons inside markers and legend items */
.map-icon-svg {
    width: 16px;
    height: 16px;
    display: inline-block;
    vertical-align: middle;
    color: inherit; /* inherit marker background color for fill via currentColor */
}

/* Ensure svg paths use currentColor when bundled - some icon svgs already support this */
.map-icon-svg svg {
    width: 16px;
    height: 16px;
}

/* MarkerCluster custom cluster icons */
.cluster,
.leaflet-marker-icon.cluster {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px !important;
    height: 40px !important;
    border-radius: 50%;
    color: #fff;
    font-weight: 700;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    border: 2px solid #fff;
    will-change: transform;
}
.cluster__inner {
    line-height: 1;
    font-size: 14px;
}
.cluster--active {
    background: #0b57d0;
}
.cluster--mixed {
    background: linear-gradient(180deg, #0b57d0, #0b57d0);
    color: #fff;
    position: relative;
}
.cluster__count {
    font-size: 13px;
    font-weight: 700;
    line-height: 1;
}
.cluster__parts {
    display: flex;
    gap: 4px;
    position: absolute;
    bottom: -6px;
    left: 50%;
    transform: translateX(-50%);
}
.cluster-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 18px;
    height: 18px;
    padding: 0 6px;
    border-radius: 99px;
    font-size: 11px;
    color: #fff;
    font-weight: 700;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}
.cluster-badge--rented {
    background: #0b57d0;
}
.cluster-badge--overdue {
    background: #f59e0b;
}
.cluster-badge--suspicious {
    background: #c62828;
}
.cluster--overdue {
    background: #f59e0b;
}
.cluster--stolen {
    background: #c62828;
}

/* Offset clusters so different status groups at same position don't overlap
   Note: Leaflet positions markers using inline transform; use margins here so offsets apply additively. */
.leaflet-marker-icon.cluster.cluster--active {
    margin-left: -50px;
    margin-top: -50px;
    z-index: 402 !important;
}
.leaflet-marker-icon.cluster.cluster--overdue {
    margin-left: 50px;
    margin-top: -50px;
    z-index: 403 !important;
}
.leaflet-marker-icon.cluster.cluster--stolen {
    margin-left: 50px;
    margin-top: 50px;
    z-index: 404 !important;
}

/* Left navigation (converted from bottom nav) */
.bottom-nav {
    position: relative;
    width: 72px;
    min-width: 72px;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    border-right: 1px solid #e5e5e5;
    background: #ffffff;
    padding: 8px 4px;
    z-index: 1000;
}

/* Map legend (filter toggles) */
.map-view {
    position: relative;
}
.legend {
    position: absolute;
    top: 10px;
    right: 10px; /* avoid overlapping Leaflet zoom (top-left) */
    left: auto;
    display: flex;
    flex-direction: column; /* vertical legend */
    align-items: flex-start; /* left-align items */
    gap: 8px;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 6px;
    z-index: 500;
    backdrop-filter: saturate(140%) blur(2px);
}
.legend__item {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 6px;
    border-radius: 6px;
    cursor: pointer;
    border: none;
    background: transparent;
    color: inherit;
    font: inherit;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
}
.legend__item:hover {
    background: #f3f4f6;
}
.legend__item.is-off {
    opacity: 0.45;
    text-decoration: line-through;
}
.legend__label {
    font-size: 12px;
}

/* Removed old geofence legend box styles (now using circular marker) */

.bottom-nav__link {
    flex: 0 0 auto;
    width: 100%;
    text-align: center;
    color: #444;
    text-decoration: none;
    font-size: 0.9rem;
    padding: 10px 4px;
    /* Make it work for both <a> and <button> */
    appearance: none;
    -webkit-appearance: none;
    background: transparent;
    border: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
    position: relative; /* for tooltip positioning */
    border-radius: 10px;
}

.bottom-nav__link.is-active {
    color: #0057e7;
    font-weight: 600;
}

/* Tooltip label: hidden by default, shows on hover/focus */
.bottom-nav__label {
    position: absolute;
    top: 50%;
    left: calc(100% + 8px);
    transform: translate(0, -50%);
    opacity: 0;
    pointer-events: none;
    background: #111;
    color: #fff;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 12px;
    line-height: 1.2;
    white-space: nowrap;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    transition: opacity 120ms ease, transform 120ms ease;
    z-index: 1001;
}
.bottom-nav__label::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 0;
    transform: translate(-100%, -50%);
    width: 0;
    height: 0;
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-right: 6px solid #111;
}
.bottom-nav__link:hover .bottom-nav__label,
.bottom-nav__link:focus .bottom-nav__label,
.bottom-nav__link:focus-visible .bottom-nav__label,
.bottom-nav__link:active .bottom-nav__label {
    opacity: 1;
    transform: translate(0, -50%);
}

/* Icon for bottom nav items that use emojis or inline SVG */
.bottom-nav__icon {
    font-size: 22px;
    line-height: 1;
}

/* Visible focus style for accessibility */
.bottom-nav__link:focus-visible {
    outline: 2px solid #0b57d0;
    outline-offset: 2px;
    border-radius: 10px;
}

/* Top-right global controls */
.top-controls {
    position: fixed;
    top: calc(8px + env(safe-area-inset-top, 0px));
    right: 8px;
    display: inline-flex;
    gap: 8px;
    align-items: center;
    background: rgba(255, 255, 255, 0.92);
    border: 1px solid #e5e5e5;
    border-radius: 999px;
    padding: 6px 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
    z-index: 1100; /* Above bottom nav (1000) and sticky headers */
}
.top-controls__link,
.top-controls__button {
    appearance: none;
    -webkit-appearance: none;
    background: transparent;
    border: none;
    color: #333;
    text-decoration: none;
    font-size: 0.95rem;
    padding: 4px 8px;
    border-radius: 6px;
    cursor: pointer;
}
.top-controls__button:hover,
.top-controls__link:hover {
    background: #f2f6ff;
    color: #0b57d0;
}

/* Login */
.login-container {
    min-height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem 1rem;
    background: linear-gradient(180deg, #f7f9fc 0%, #ffffff 100%);
}
.login-card {
    width: 100%;
    max-width: 420px;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
    padding: 1.25rem;
}
.login-title {
    margin: 0 0 1rem;
    font-size: 1.5rem;
}
.login-form {
    display: grid;
    gap: 0.75rem;
}
.login-label {
    font-size: 0.9rem;
    color: #333;
}
.login-input {
    padding: 0.6rem 0.7rem;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
}
.login-button {
    margin-top: 0.25rem;
    background: #0057e7;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 0.7rem 1rem;
    font-size: 1rem;
    cursor: pointer;
}
.login-button:hover {
    background: #064dc9;
}
.login-help {
    margin-top: 0.75rem;
    color: #666;
    font-size: 0.9rem;
}

/* Generic form styles */
.form-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.6rem;
    max-width: 640px;
}
.form-label {
    font-size: 0.9rem;
    color: #333;
}
.form-input {
    padding: 0.55rem 0.7rem;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
}
.form-actions {
    margin-top: 0.5rem;
}
.form-button {
    background: #0057e7;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 0.7rem 1rem;
    font-size: 1rem;
    cursor: pointer;
}
.form-button:hover {
    background: #064dc9;
}

/* Small inline button for table actions */
.mini-button {
    background: #f3f4f6;
    color: #111827;
    border: 1px solid #e5e7eb;
    border-radius: 999px;
    padding: 4px 10px;
    font-size: 12px;
    cursor: pointer;
}
.mini-button.is-on {
    background: #0b57d0;
    color: #fff;
    border-color: #0b57d0;
}

/* Scroll containers between sticky header and bottom nav */
.page-scroll {
    flex: 1 1 auto;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: auto;
    padding-bottom: 0;
}

/* Normalize headings to avoid extra top margins pushing layout */
.page > h1 {
    margin: 0 0 0.75rem;
}
/* Global sizing reset to avoid off-by-one overflows */
html {
    box-sizing: border-box;
}
*,
*::before,
*::after {
    box-sizing: inherit;
}

/* Dashboard */
.dashboard-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
}
@media (min-width: 920px) {
    .dashboard-grid {
        grid-template-columns: 1fr 1fr;
    }
    .dashboard-grid--gauges {
        grid-template-columns: repeat(3, 1fr);
    }
}
.card {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 12px;
    padding: 1rem;
}
.section-title {
    margin: 0 0 0.5rem;
    font-size: 1.1rem;
}
.chart-card .chart-wrap {
    /* Responsive to both width and height; never exceed a fraction of viewport */
    height: min(clamp(160px, 34vw, 260px), 38vh);
}
.gauge-card {
    text-align: center;
}
.gauge {
    width: 100%;
    max-width: 280px;
    margin: 0 auto;
}
.gauge {
    /* Ensure the container keeps space for the semicircle so parent flex layouts don't squash it */
    min-height: 140px; /* reasonable default for size ~280 */
}
.gauge svg {
    width: 100%;
    height: 90%;
    display: block;
}
.gauge-title {
    font-weight: 600;
    margin-bottom: 0.25rem;
}
.gauge-sub {
    display: block;
    font-weight: 400;
    font-size: 0.85rem;
    color: #6b7280;
}
.gauge-footer {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.6rem;
    margin-top: -6px;
}
.gauge-value {
    font-size: 1.6rem;
    font-weight: 700;
}
.gauge-delta {
    font-size: 0.95rem;
    color: #374151;
}
.gauge-delta.up {
    color: #065f46;
}
.gauge-delta.down {
    color: #991b1b;
}

/* Simple modal styles */
.modal-backdrop {
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding: 40px 16px;
    z-index: 1200;
}
.modal {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 12px;
    width: 100%;
    max-width: 720px;
    padding: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    max-height: calc(100vh - 80px);
    overflow: auto;
}
